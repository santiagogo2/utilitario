<div class="loaderBall" *ngIf="!loadedInfo">
    <div class="ball-pulse-rise">
        <div></div>
        <div></div>
        <div></div>
        <div></div>
        <div></div>
    </div>
</div>
<form [formGroup]="patientForm" *ngIf="loadedInfo">
    <div class="form-group">
        <div class="col col-sm-9 col-lg-5 d-inline-block align-top">
            <label for=" documento" class="labelForm">Documento*</label>
            <input type="text" formControlName="documento" name="documento" class="form-control inputForm" [ngClass]="{ 'is-invalid': patientForm.controls.documento.touched && patientForm.controls.documento.invalid}" maxlength='15' required>
        </div>
        <div class="col col-sm-3 col-lg-2 d-inline-block align-bottom">
            <a class="btn btn-info btn-sm col-sm-12 enlarge" style="color: white; border-radius: 0;" *ngIf="patientForm.controls.documento.valid" (click)="searchPatient()">Buscar</a>
        </div>
        <div class="col col-sm-12 col-lg-5 d-inline-block align-top">
            <label for="tipoDocumento" class="labelForm">Tipo de documento*</label>
            <select style="background-position-x: 93%" formControlName="tipoDocumento" name="tipoDocumento" id="tipoDocumento" class="form-control inputForm" [ngClass]="{'is-invalid': patientForm.controls.tipoDocumento.invalid && patientForm.controls.tipoDocumento.touched}"
                required>
				<option *ngFor="let tipo of tipoDocumentos" value="{{ tipo.id }}">{{ tipo.value }}</option>
			</select>
        </div>
        <div class="col-sm-12" *ngIf="patientPreloaderStatus">
            <fa-icon [icon]="faSpinner" class="d-block spin"></fa-icon>
        </div>
        <div class="col col-sm-12" *ngIf="patienSearchResponseMessage">
            <small class="invalid-feedback d-block">{{ patienSearchResponseMessage }}</small>
        </div>
    </div>
    <div class="form-group">
        <div class="col col-sm-12 col-lg-3 d-inline-block align-top">
            <label for="primerNombre" class="labelForm">Primer nombre*</label>
            <input type="text" formControlName="primerNombre" name="primerNombre" class="form-control inputForm" [ngClass]="{'is-invalid': patientForm.controls.primerNombre.touched && patientForm.controls.primerNombre.invalid}" maxlength="50" placeholder="Ingrese el primer nombre">
        </div>
        <div class="col col-sm-12 col-lg-3 d-inline-block align-top">
            <label for="segundoNombre" class="labelForm">Segundo nombre</label>
            <input type="text" formControlName="segundoNombre" name="segundoNombre" class="form-control inputForm" [ngClass]="{'is-invalid': patientForm.controls.segundoNombre.touched && patientForm.controls.segundoNombre.invalid}" maxlength="50" placeholder="Ingrese el segundo nombre">
        </div>
        <div class="col col-sm-12 col-lg-3 d-inline-block align-top">
            <label for="primerApellido" class="labelForm">Primer apellido*</label>
            <input type="text" formControlName="primerApellido" name="primerApellido" class="form-control inputForm" [ngClass]="{'is-invalid': patientForm.controls.primerApellido.touched && patientForm.controls.primerApellido.invalid}" required maxlength="50" placeholder="Ingrese el primer apellido">
        </div>
        <div class="col col-sm-12 col-lg-3 d-inline-block align-top">
            <label for="segundoApellido" class="labelForm">Segundo apellido</label>
            <input type="text" formControlName="segundoApellido" name="segundoApellido" class="form-control inputForm" [ngClass]="{'is-invalid': patientForm.controls.segundoApellido.touched && patientForm.controls.segundoApellido.invalid}" maxlength="50" placeholder="Ingrese el segundo apellido">
        </div>
    </div>
    <div class="form-group">
        <div class="col col-sm-12 col-lg-4 d-inline-block align-top">
            <label for="edad" class="labelForm">Edad*</label>
            <input type="text" formControlName="edad" name="edad" class="form-control inputForm" [ngClass]="{ 'is-invalid': patientForm.controls.edad.touched && patientForm.controls.edad.invalid}" maxlength="3" pattern="[0-9]+" required>
        </div>
        <div class="col col-sm-12 col-lg-4 d-inline-block align-top">
            <label for="unidadMedida" class="labelForm">Unidad de medida*</label>
            <select style="background-position-x: 93%" formControlName="unidadMedida" name="unidadMedida" class="form-control inputForm" [ngClass]="{'is-invalid': patientForm.controls.unidadMedida.invalid && patientForm.controls.unidadMedida.touched}" required>
				<option *ngFor="let unidad of unidadesMedida" value="{{ unidad.id }}">{{ unidad.name }}</option>
			</select>
        </div>
        <div class="col col-sm-12 col-lg-4 d-inline-block align-top">
            <label for="sexo" class="labelForm">Sexo*</label>
            <select style="background-position-x: 93%" formControlName="sexo" name="sexo" class="form-control inputForm" [ngClass]="{'is-invalid': patientForm.controls.sexo.invalid && patientForm.controls.sexo.touched}" required>
				<option *ngFor="let sexo of sexos" value="{{ sexo.id }}">{{ sexo.value }}</option>
			</select>
        </div>
    </div>
    <div class="form-group">
        <div class="col col-sm-12 col-lg-6 d-inline-block align-top">
            <label for="nacionalidad" class="labelForm">Nacionalidad*</label>
            <select style="background-position-x: 93%" formControlName="nacionalidad" name="nacionalidad" class="form-control inputForm" [ngClass]="{'is-invalid': patientForm.controls.nacionalidad.invalid && patientForm.controls.nacionalidad.touched}" required>
				<option *ngFor="let nacionalidad of nacionalidades" value="{{ nacionalidad.id }}">{{ nacionalidad.name }}</option>
			</select>
        </div>
        <div class="col col-sm-12 col-lg-6 d-inline-block align-top">
            <label for="ocupacion" class="labelForm">Ocupación*</label>
            <select style="background-position-x: 93%" formControlName="ocupacion" name="ocupacion" class="form-control inputForm" [ngClass]="{'is-invalid': patientForm.controls.ocupacion.invalid && patientForm.controls.ocupacion.touched}" required>
				<option *ngFor="let ocupacion of ocupaciones" value="{{ ocupacion.id }}">{{ ocupacion.name }}</option>
			</select>
        </div>
    </div>
    <div class="form-group">
        <div class="col col-sm-12 col-lg-6 d-inline-block align-top">
            <label for="pertenenciaEtnica" class="labelForm">Pertenencia Étnica*</label>
            <select style="background-position-x: 93%" formControlName="pertenenciaEtnica" name="pertenenciaEtnica" class="form-control inputForm" [ngClass]="{'is-invalid': patientForm.controls.pertenenciaEtnica.invalid && patientForm.controls.pertenenciaEtnica.touched}"
                required>
				<option *ngFor="let pertenencia of pertenenciasEtnicas" value="{{ pertenencia.id }}">{{ pertenencia.name }}</option>
			</select>
        </div>
        <div class="col col-sm-12 col-lg-6 d-inline-block align-top">
            <label for="grupoPoblacional" class="labelForm">Grupo Poblacional*</label>
            <select style="background-position-x: 93%" formControlName="grupoPoblacional" name="grupoPoblacional" class="form-control inputForm" [ngClass]="{'is-invalid': patientForm.controls.grupoPoblacional.invalid && patientForm.controls.grupoPoblacional.touched}"
                required>
				<option *ngFor="let grupo of gruposPoblacionales" value="{{ grupo.id }}">{{ grupo.name }}</option>
			</select>
        </div>
    </div>
    <div class="form-group">
        <div class="col col-sm-12 col-lg-6 d-inline-block align-top">
            <label for="direccion" class="labelForm">Direccion*</label>
            <input type="text" formControlName="direccion" name="direccion" class="form-control inputForm" [ngClass]="{ 'is-invalid': patientForm.controls.direccion.touched && patientForm.controls.direccion.invalid}" maxlength="100" required>
        </div>
        <div class="col col-sm-12 col-lg-6 d-inline-block align-top">
            <label for="barrio" class="labelForm">Barrio*</label>
            <input type="text" formControlName="barrio" name="barrio" class="form-control inputForm" [ngClass]="{ 'is-invalid': patientForm.controls.barrio.touched && patientForm.controls.barrio.invalid}" maxlength="100" required>
        </div>
    </div>
    <div class="form-group">
        <div class="col col-sm-12 col-lg-6 d-inline-block align-top">
            <label for="location" class="labelForm">Localidad de residencia*</label>
            <select style="background-position-x: 93%" formControlName="location" name="location" id="location" class="form-control inputForm" [ngClass]="{'is-invalid': patientForm.controls.location.invalid && patientForm.controls.location.touched}" required (change)="getUpzs()">
				<option *ngFor="let localidad of localidades" value="{{ localidad.id }}">{{ localidad.name }}</option>
			</select>
        </div>
        <div class="col col-sm-12 col-lg-6 d-inline-block align-top" *ngIf="upzs && patientForm.controls.location.value!=5">
            <label for="upz" class="labelForm">UPZ*</label>
            <select style="background-position-x: 93%" formControlName="upz" name="upz" id="upz" class="form-control inputForm" [ngClass]="{'is-invalid': patientForm.controls.upz.invalid && patientForm.controls.upz.touched}" required>
				<option *ngFor="let upz of upzs" value="{{ upz.id }}">{{ upz.name }}</option>
			</select>
        </div>
        <div class="col-sm-12 col-md-6 d-inline-block align-bottom" *ngIf="upzPreloaderStatus">
            <fa-icon [icon]="faSpinner" class="d-block spin"></fa-icon>
        </div>
        <div class="col-sm-12 col-md-6 d-inline-block align-bottom" *ngIf="upzSearchResponseMessage"><small class="invalid-feedback d-block">{{ upzSearchResponseMessage }}</small></div>
    </div>
    <div class="form-group">
        <div class="col col-sm-12 col-lg-6 d-inline-block align-top">
            <label for="telefono" class="labelForm">Telefono*</label>
            <input type="text" formControlName="telefono" name="telefono" class="form-control inputForm" [ngClass]="{ 'is-invalid': patientForm.controls.telefono.touched && patientForm.controls.telefono.invalid}" maxlength="10" pattern="[0-9]+" required>
        </div>
        <div class="col col-sm-12 col-lg-6 d-inline-block align-top">
            <label for="insurer" class="labelForm">Aseguradora*</label>
            <select style="background-position-x: 93%" formControlName="insurer" name="insurer" id="insurer" class="form-control inputForm" [ngClass]="{'is-invalid': patientForm.controls.insurer.invalid && patientForm.controls.insurer.touched}" required>
				<option *ngFor="let insurer of insurers" value="{{ insurer.id }}">{{ insurer.name }}</option>
			</select>
        </div>
    </div>
</form>
<div class="tableContainer col col-sm-12">
    <div class="tableContainerAll col col-sm-12 col-lg-6 d-inline-block align-top" *ngIf="indices">
        <h5 class="h5Title">Es contacto de los índices</h5>
        <table class="table table-bordered">
            <thead class="thead_styles">
                <tr>
                    <th>Número de docuento</th>
                    <th>Nombres y apellidos</th>
                </tr>
            </thead>
            <tbody class="tbody_styles">
                <tr *ngFor="let indice of indices" class="tableStyles">
                    <td>{{ indice.indices.documento }}</td>
                    <td>{{ indice.indices.primerNombre + ' ' + (indice.indices.segundoNombre | isnull) + ' ' + indice.indices.primerApellido + ' ' + (indice.indices.segundoApellido | isnull) }}</td>
                </tr>
            </tbody>
        </table>
    </div>
    <div class="tableContainerAll col col-sm-12 col-lg-6 d-inline-block align-top" *ngIf="contacts">
        <h5 class="h5Title">Contactos del paciente</h5>
        <table class="table table-bordered">
            <thead class="thead_styles">
                <tr>
                    <th>Número de docuento</th>
                    <th>Nombres y apellidos</th>
                </tr>
            </thead>
            <tbody class="tbody_styles">
                <tr *ngFor="let contact of contacts" class="tableStyles">
                    <td>{{ contact.contacts.documento }}</td>
                    <td>{{ contact.contacts.primerNombre + ' ' + (contact.contacts.segundoNombre | isnull) + ' ' + contact.contacts.primerApellido + ' ' + (contact.contacts.segundoApellido | isnull) }}</td>
                </tr>
            </tbody>
        </table>
    </div>
</div>